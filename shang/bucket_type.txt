I0817 15:06:56.282235  2927 [GlobalIOThreadP] BlockAllocatorSloLogger.cpp:200] isInRegionUser: 1 isHostHealthy: 1
2025-08-17T15:06:56.696-0700	WARN	http-worker-2505	com.facebook.presto.server.ThrowableMapper	Request failed for /v1/task/20250817_220650_02662_n52un.1.0.64.0
com.facebook.presto.spi.PrestoException: Can not deserialize instance from bytes
	at com.facebook.presto.server.thrift.ThriftCodecWrapper.fromBytes(ThriftCodecWrapper.java:74)
	at com.facebook.presto.server.thrift.ThriftTaskUpdateRequestBodyReader.readFrom(ThriftTaskUpdateRequestBodyReader.java:61)
	at com.facebook.presto.server.thrift.ThriftTaskUpdateRequestBodyReader.readFrom(ThriftTaskUpdateRequestBodyReader.java:38)
	at org.glassfish.jersey.message.internal.ReaderInterceptorExecutor$TerminalReaderInterceptor.invokeReadFrom(ReaderInterceptorExecutor.java:257)
	at org.glassfish.jersey.message.internal.ReaderInterceptorExecutor$TerminalReaderInterceptor.aroundReadFrom(ReaderInterceptorExecutor.java:236)
	at org.glassfish.jersey.message.internal.ReaderInterceptorExecutor.proceed(ReaderInterceptorExecutor.java:156)
	at org.glassfish.jersey.server.internal.MappableExceptionWrapperInterceptor.aroundReadFrom(MappableExceptionWrapperInterceptor.java:73)
	at org.glassfish.jersey.message.internal.ReaderInterceptorExecutor.proceed(ReaderInterceptorExecutor.java:156)
	at org.glassfish.jersey.message.internal.MessageBodyFactory.readFrom(MessageBodyFactory.java:1091)
	at org.glassfish.jersey.message.internal.InboundMessageContext.readEntity(InboundMessageContext.java:874)
	at org.glassfish.jersey.server.ContainerRequest.readEntity(ContainerRequest.java:271)
	at org.glassfish.jersey.server.internal.inject.EntityParamValueParamProvider$EntityValueSupplier.apply(EntityParamValueParamProvider.java:97)
	at org.glassfish.jersey.server.internal.inject.EntityParamValueParamProvider$EntityValueSupplier.apply(EntityParamValueParamProvider.java:80)
	at org.glassfish.jersey.server.spi.internal.ParamValueFactoryWithSource.apply(ParamValueFactoryWithSource.java:74)
	at org.glassfish.jersey.server.spi.internal.ParameterValueHelper.getParameterValues(ParameterValueHelper.java:92)
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$AbstractMethodParamInvoker.getParamValues(JavaResourceMethodDispatcherProvider.java:133)
	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$ResponseOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:200)
	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:103)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:493)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:415)
	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:104)
	at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:277)
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:272)
	at org.glassfish.jersey.internal.Errors$1.call(Errors.java:268)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:316)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:298)
	at org.glassfish.jersey.internal.Errors.process(Errors.java:268)
	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:289)
	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:256)
	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:703)
	at org.glassfish.jersey.servlet.WebComponent.serviceImpl(WebComponent.java:416)
	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:370)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:389)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:342)
	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:229)
	at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)
	at org.eclipse.jetty.servlet.ServletHandler$ChainEnd.doFilter(ServletHandler.java:1656)
	at com.facebook.presto.server.AsyncPageTransportForwardFilter.doFilter(AsyncPageTransportForwardFilter.java:55)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at com.facebook.presto.server.security.AuthenticationFilter.doFilter(AuthenticationFilter.java:92)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at com.facebook.airlift.http.server.TraceTokenFilter.doFilter(TraceTokenFilter.java:63)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at com.facebook.airlift.http.server.TimingFilter.doFilter(TimingFilter.java:51)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:722)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:181)
	at org.eclipse.jetty.server.handler.HandlerList.handle(HandlerList.java:59)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: com.facebook.airlift.http.client.thrift.ThriftProtocolException: Invalid thrift object for Java type java.lang.Class
	at com.facebook.airlift.http.client.thrift.ThriftProtocolUtils.read(ThriftProtocolUtils.java:46)
	at com.facebook.presto.server.thrift.ThriftCodecWrapper.fromBytes(ThriftCodecWrapper.java:71)
	... 79 more
Caused by: com.facebook.presto.spi.PrestoException: Can not deserialize hive split
	at com.facebook.presto.hive.thrift.HiveSplitCodec.deserialize(HiveSplitCodec.java:57)
	at com.facebook.presto.hive.thrift.HiveSplitCodec.deserialize(HiveSplitCodec.java:29)
	at com.facebook.presto.server.thrift.ConnectorSplitThriftCodec.lambda$readConcreteValue$0(ConnectorSplitThriftCodec.java:66)
	at java.base/java.util.Optional.map(Optional.java:260)
	at com.facebook.presto.server.thrift.ConnectorSplitThriftCodec.readConcreteValue(ConnectorSplitThriftCodec.java:66)
	at com.facebook.presto.server.thrift.ConnectorSplitThriftCodec.readConcreteValue(ConnectorSplitThriftCodec.java:31)
	at com.facebook.presto.server.thrift.AbstractTypedThriftCodec.read(AbstractTypedThriftCodec.java:154)
	at com.facebook.drift.codec.internal.ProtocolReader.readStructField(ProtocolReader.java:245)
	at $drift.com.facebook.presto.metadata.SplitCodec.read(Unknown Source)
	at $drift.com.facebook.presto.metadata.SplitCodec.read(Unknown Source)
	at com.facebook.drift.codec.internal.ProtocolReader.readStructField(ProtocolReader.java:245)
	at $drift.com.facebook.presto.execution.ScheduledSplitCodec.read(Unknown Source)
	at $drift.com.facebook.presto.execution.ScheduledSplitCodec.read(Unknown Source)
	at com.facebook.drift.codec.internal.ProtocolReader.readSet(ProtocolReader.java:509)
	at com.facebook.drift.codec.internal.builtin.SetThriftCodec.read(SetThriftCodec.java:55)
	at com.facebook.drift.codec.internal.builtin.SetThriftCodec.read(SetThriftCodec.java:31)
	at com.facebook.drift.codec.internal.ProtocolReader.readSetField(ProtocolReader.java:329)
	at $drift.com.facebook.presto.execution.TaskSourceCodec.read(Unknown Source)
	at $drift.com.facebook.presto.execution.TaskSourceCodec.read(Unknown Source)
	at com.facebook.drift.codec.internal.ProtocolReader.readList(ProtocolReader.java:527)
	at com.facebook.drift.codec.internal.builtin.ListThriftCodec.read(ListThriftCodec.java:55)
	at com.facebook.drift.codec.internal.builtin.ListThriftCodec.read(ListThriftCodec.java:31)
	at com.facebook.drift.codec.internal.ProtocolReader.readListField(ProtocolReader.java:341)
	at $drift.com.facebook.presto.server.TaskUpdateRequestCodec.read(Unknown Source)
	at $drift.com.facebook.presto.server.TaskUpdateRequestCodec.read(Unknown Source)
	at com.facebook.airlift.http.client.thrift.ThriftProtocolUtils.read(ThriftProtocolUtils.java:43)
	... 80 more
Caused by: com.facebook.drift.protocol.TProtocolException: Can not deserialize the data
	at com.facebook.presto.hive.thrift.ThriftCodecUtils.fromThrift(ThriftCodecUtils.java:124)
	at com.facebook.presto.hive.thrift.HiveSplitCodec.deserialize(HiveSplitCodec.java:54)
	... 105 more
Caused by: java.lang.IllegalArgumentException: Invalid JSON string for [simple type, class com.facebook.presto.hive.HiveBucketProperty]
	at com.facebook.airlift.json.JsonCodec.fromJson(JsonCodec.java:140)
	at com.facebook.presto.hive.thrift.ThriftCodecUtils.readSingleJsonField(ThriftCodecUtils.java:98)
	at com.facebook.presto.hive.thrift.HiveBucketPropertyThriftCodec.read(HiveBucketPropertyThriftCodec.java:63)
	at com.facebook.presto.hive.thrift.HiveBucketPropertyThriftCodec.read(HiveBucketPropertyThriftCodec.java:31)
	at com.facebook.drift.codec.internal.builtin.OptionalThriftCodec.read(OptionalThriftCodec.java:53)
	at com.facebook.drift.codec.internal.builtin.OptionalThriftCodec.read(OptionalThriftCodec.java:29)
	at com.facebook.drift.codec.internal.ProtocolReader.readField(ProtocolReader.java:113)
	at $drift.com.facebook.presto.hive.metastore.StorageCodec.read(Unknown Source)
	at $drift.com.facebook.presto.hive.metastore.StorageCodec.read(Unknown Source)
	at com.facebook.drift.codec.internal.ProtocolReader.readStructField(ProtocolReader.java:245)
	at $drift.com.facebook.presto.hive.HiveSplitCodec.read(Unknown Source)
	at $drift.com.facebook.presto.hive.HiveSplitCodec.read(Unknown Source)
	at com.facebook.presto.hive.thrift.ThriftCodecUtils.fromThrift(ThriftCodecUtils.java:121)
	... 106 more
Caused by: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Cannot construct instance of `com.facebook.presto.common.type.Type` (no Creators, like default constructor, exist): abstract types either need to be mapped to concrete types, have custom deserializer, or contain additional type information
 at [Source: (String)"{"bucketedBy":["_c0_snapshot_time","_c1_group_id","_c2_ds"],"bucketCount":4096,"sortedBy":[],"bucketFunctionType":"PRESTO_NATIVE","types":["bigint","bigint","varchar"]}"; line: 1, column: 140] (through reference chain: com.facebook.presto.hive.HiveBucketProperty["types"]->java.util.ArrayList[0])
	at com.fasterxml.jackson.databind.exc.InvalidDefinitionException.from(InvalidDefinitionException.java:67)
	at com.fasterxml.jackson.databind.DeserializationContext.reportBadDefinition(DeserializationContext.java:1915)
	at com.fasterxml.jackson.databind.DatabindContext.reportBadDefinition(DatabindContext.java:414)
	at com.fasterxml.jackson.databind.DeserializationContext.handleMissingInstantiator(DeserializationContext.java:1360)
	at com.fasterxml.jackson.databind.deser.AbstractDeserializer.deserialize(AbstractDeserializer.java:274)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer._deserializeFromArray(CollectionDeserializer.java:359)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:244)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:28)
	at com.fasterxml.jackson.databind.deser.std.ReferenceTypeDeserializer.deserialize(ReferenceTypeDeserializer.java:204)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:545)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeWithErrorWrapping(BeanDeserializer.java:570)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:439)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromObjectUsingNonDefault(BeanDeserializerBase.java:1419)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:352)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:185)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectReader._bindAndClose(ObjectReader.java:2105)
	at com.fasterxml.jackson.databind.ObjectReader.readValue(ObjectReader.java:1546)
	at com.facebook.airlift.json.JsonCodec.fromJson(JsonCodec.java:137)
	... 118 more
